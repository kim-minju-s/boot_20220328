<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Item">

    <insert id="insertItemOne" parameterType="com.example.dto.ItemDTO">
        INSERT INTO ITEM(ICODE, INAME, ICONTENT, IPRICE, IQUANTITY, IIMAGE, IIMAGESIZE, IIMAGETYPE, IIMAGENAME, UEMAIL)
        VALUES(SEQ_ITEM_ICODE.NEXTVAL, #{iname}, #{icontent}, #{iprice}, #{iquantity}, #{iimage, jdbcType=BLOB}, #{iimagesize}, #{iimagetype}, #{iimagename}, #{uemail})
    </insert>

    <select id="selectItemList" parameterType="map" resultType="com.example.dto.ItemDTO">
        SELECT*FROM (
            SELECT
                I.ICODE, I.INAME, I.IPRICE, I.IQUANTITY, I.IREGDATE, ROW_NUMBER() OVER (ORDER BY ICODE DESC) ROWN 
            FROM ITEM I
            WHERE I.INAME LIKE '%' || #{txt} || '%'
        )
        WHERE ROWN BETWEEN #{start} AND #{end}
    </select>

    <select id="selectItemCount" parameterType="String" resultType="long">
            SELECT
                COUNT(*) CNT 
            FROM ITEM I
            WHERE I.INAME LIKE '%' || #{txt} || '%'
    </select>

</mapper>
